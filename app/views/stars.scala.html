@* Copyright 2014 Fabian Steeg, hbz. Licensed under the GPLv2 *@

@(ids: List[String])

@import helper._
@import play.api.libs.ws._
@import scala.concurrent.Future
@import scala.concurrent.ExecutionContext.Implicits.global
@import scala.concurrent._
@import scala.concurrent.duration._
@import play.api.Play.current

@main("NWBib - Merkliste") {
    @if(ids.isEmpty){
        <div class="alert alert-info text-center">
            Keine gemerkten Titel. Sie können Titel in der Trefferliste oder der Einzeltrefferanzeige durch Klicken des Sterns hinzufügen.
        </div>
    } else {
        <table class="table table-striped table-condensed">
        <tr>
          <th style="width: 5%"></th>
          <th style="width: 60%"></th>
          <th style="width: 25%; text-align: right"></th>
          <th style="width: 5%; text-align: right"></th>
          <th style="width: 5%; text-align: right"></th>
        </tr>
        @for(
        (id,i) <- ids.zipWithIndex;
        url = s"http://lobid.org/resource/$id?format=full";
        doc = Await.result(WS.url(url).get.map{response => response.json}, 10.seconds)) {
                @tags.result_short(id,doc,i,ids)
        }
        </table>
        <div class="text-center" id="clear-list">
            <a style="cursor:pointer;"
                onclick="$('#clear-list').html('Bestätigung: <a href=\'@nwbib.routes.Application.clearStars()\'>Merkliste dauerhaft löschen</a> | <a style=\'cursor:pointer\'; onclick=\'window.location.reload()\'>Abbrechen</a>')">
                <span class="glyphicon glyphicon-remove"></span> Merkliste löschen
            </a>
        </div>
    }
    @if(flash.get("error")!=null){
        <div class="alert alert-danger">@flash.get("error")</div>
    }
}
